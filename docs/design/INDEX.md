# è®¾è®¡æ–‡æ¡£ç´¢å¼•

æœ¬ç´¢å¼•åˆ—å‡ºæ‰€æœ‰ç³»ç»Ÿè®¾è®¡å’Œæ¶æ„æ–‡æ¡£ï¼ŒæŒ‰æ¨¡å—åˆ†ç±»ç»„ç»‡ï¼Œä¾¿äºå¿«é€ŸæŸ¥æ‰¾å’Œç†è§£ç³»ç»Ÿè®¾è®¡å…¨è²Œã€‚

## ğŸ“‹ æ–‡æ¡£æ¦‚è§ˆ

| æ–‡æ¡£åç§°                                                                   | æè¿°                     | çŠ¶æ€      | æœ€åæ›´æ–°   |
| -------------------------------------------------------------------------- | ------------------------ | --------- | ---------- |
| [ID è®¾è®¡è§„èŒƒ](./id-design.md)                                              | ç³»ç»Ÿ ID ç”Ÿæˆå’Œç®¡ç†æœºåˆ¶   | âœ… å·²ç¡®è®¤ | 2025-01-07 |
| [æ€ç»´å¯¼å›¾ç¼–è¾‘å™¨ Store è®¾è®¡](./mindmap-editor-store-design.md)              | ç¼–è¾‘å™¨çŠ¶æ€ç®¡ç†æ¶æ„       | âœ… å·²ç¡®è®¤ | 2025-01-06 |
| [æ€ç»´å¯¼å›¾ç¼–è¾‘å™¨å¸ƒå±€è®¾è®¡](./mindmap-editor-layout-design.md)                | ç¼–è¾‘å™¨ç•Œé¢å¸ƒå±€å’Œç»„ä»¶åä½œ | âœ… å·²ç¡®è®¤ | 2025-10-19 |
| [IndexedDB æŒä¹…åŒ–ä¸­é—´ä»¶è®¾è®¡](./indexeddb-persistence-middleware-design.md) | æœ¬åœ°æ•°æ®æŒä¹…åŒ–æ–¹æ¡ˆ       | âœ… å·²ç¡®è®¤ | 2025-01-04 |
| [æ€ç»´å¯¼å›¾æŒä¹…åŒ–ç³»ç»Ÿè®¾è®¡](./mindmap-persistence-design.md)                  | ä¸‰å±‚æ•°æ®æµæ¶æ„å’ŒåŒæ­¥æœºåˆ¶ | âœ… å·²ç¡®è®¤ | 2025-10-18 |

## ğŸ—ï¸ æŒ‰æ¨¡å—åˆ†ç±»

### æ ¸å¿ƒåŸºç¡€è®¾æ–½

#### ID æœºåˆ¶

- **[ID è®¾è®¡è§„èŒƒ](./id-design.md)**
  - UUID ä½œä¸ºä¸»é”®è®¾è®¡
  - short_id ç”Ÿæˆç­–ç•¥ï¼ˆ10å­—ç¬¦ base36ï¼‰
  - èŒƒå›´å”¯ä¸€æ€§ä¿è¯
  - å‰ç«¯/åç«¯ç”Ÿæˆç­–ç•¥

### å‰ç«¯ UI

#### å¸ƒå±€å’Œç»„ä»¶

- **[æ€ç»´å¯¼å›¾ç¼–è¾‘å™¨å¸ƒå±€è®¾è®¡](./mindmap-editor-layout-design.md)**
  - ä¸‰æ å¼ç¼–è¾‘å™¨ç•Œé¢
  - å¯è°ƒæ•´å®½åº¦é¢æ¿
  - è™šæ‹ŸåŒ–å¤§çº²è§†å›¾ï¼ˆreact-arboristï¼‰
  - å›¾å½¢è§†å›¾ï¼ˆReact Flowï¼‰
  - æŠ˜å èŠ‚ç‚¹é«˜äº®å’Œå¯¼èˆª
  - å¸ƒå±€çŠ¶æ€æŒä¹…åŒ–

### æ•°æ®ç®¡ç†

#### çŠ¶æ€ç®¡ç†

- **[æ€ç»´å¯¼å›¾ç¼–è¾‘å™¨ Store è®¾è®¡](./mindmap-editor-store-design.md)**
  - Zustand + Immer æ¶æ„
  - é¢†åŸŸé©±åŠ¨çš„çŠ¶æ€è®¾è®¡
  - èŠ‚ç‚¹æ“ä½œå’Œçº¦æŸä¿è¯
  - ç„¦ç‚¹ä¸é€‰ä¸­æœºåˆ¶

#### æ•°æ®æŒä¹…åŒ–

- **[IndexedDB æŒä¹…åŒ–ä¸­é—´ä»¶è®¾è®¡](./indexeddb-persistence-middleware-design.md)**
  - åŒå±‚æ•°æ®æ¶æ„ï¼ˆæœ¬åœ°ç¼“å­˜ + äº‘ç«¯ï¼‰
  - è‡ªåŠ¨åŒæ­¥æœºåˆ¶
  - å†²çªè§£å†³ç­–ç•¥
  - ç¦»çº¿æ”¯æŒæ–¹æ¡ˆ
- **[æ€ç»´å¯¼å›¾æŒä¹…åŒ–ç³»ç»Ÿè®¾è®¡](./mindmap-persistence-design.md)**
  - ä¸‰å±‚æ•°æ®æµæ¶æ„ï¼ˆStore â†’ IndexedDB â†’ Supabaseï¼‰
  - Auto-Persistence ä¸­é—´ä»¶å®ç°
  - è„æ•°æ®è¿½è¸ªå’Œæ‰¹é‡åŒæ­¥
  - æ—¶é—´æˆ³å†²çªæ£€æµ‹æœºåˆ¶
  - æ‹“æ‰‘æ’åºèŠ‚ç‚¹ä¸Šä¼ ç­–ç•¥

### è‰ç¨¿æ–‡æ¡£ï¼ˆå¾…ç¡®è®¤ï¼‰

- **[æ€ç»´å¯¼å›¾æŒä¹…åŒ–éœ€æ±‚](../draft/mindmap-persistence-requirements.md)** _(è‰ç¨¿)_
  - è¯¦ç»†çš„æŒä¹…åŒ–åŠŸèƒ½éœ€æ±‚åˆ†æ
  - åŒ…å«1400+è¡Œçš„è¯¦ç»†è§„æ ¼è¯´æ˜

## ğŸ”— æ–‡æ¡£å…³ç³»å›¾

```mermaid
graph TD
    A[ID è®¾è®¡è§„èŒƒ] --> B[Store è®¾è®¡]
    B --> C[æŒä¹…åŒ–ä¸­é—´ä»¶]
    C --> D[æŒä¹…åŒ–éœ€æ±‚<br/>è‰ç¨¿]
    D --> I[æŒä¹…åŒ–ç³»ç»Ÿè®¾è®¡]

    B --> J[å¸ƒå±€è®¾è®¡]

    B -.->|ä½¿ç”¨| E[Zustand]
    B -.->|ä½¿ç”¨| F[Immer]
    C -.->|ä½¿ç”¨| G[IndexedDB]
    C -.->|è¿æ¥| H[Supabase]
    I -.->|ä½¿ç”¨| G
    I -.->|ä½¿ç”¨| H
    I -.->|å®ç°| C

    J -.->|è¯»å–| B
    J -.->|ä½¿ç”¨| K[react-arborist]
    J -.->|ä½¿ç”¨| L[React Flow]

    style D fill:#fffacd
    style E fill:#e1f5fe
    style F fill:#e1f5fe
    style G fill:#e1f5fe
    style H fill:#e1f5fe
    style K fill:#e1f5fe
    style L fill:#e1f5fe
```

**å›¾ä¾‹**:

- é»„è‰²ï¼šè‰ç¨¿æ–‡æ¡£
- è“è‰²ï¼šå¤–éƒ¨ä¾èµ–

## ğŸ“Š è®¾è®¡å†³ç­–è®°å½•

### å·²ç¡®å®šçš„æŠ€æœ¯é€‰å‹

| é¢†åŸŸ           | æŠ€æœ¯é€‰æ‹©        | ç†ç”±                         | ç›¸å…³æ–‡æ¡£                                                     |
| -------------- | --------------- | ---------------------------- | ------------------------------------------------------------ |
| **ID ç”Ÿæˆ**    | UUID + short_id | å…¼é¡¾å”¯ä¸€æ€§å’Œç”¨æˆ·å‹å¥½æ€§       | [ID è®¾è®¡](./id-design.md)                                    |
| **çŠ¶æ€ç®¡ç†**   | Zustand + Immer | è½»é‡çº§ã€ç±»å‹å®‰å…¨ã€ä¸å¯å˜æ›´æ–° | [Store è®¾è®¡](./mindmap-editor-store-design.md)               |
| **æœ¬åœ°å­˜å‚¨**   | IndexedDB       | å¤§å®¹é‡ã€ç»“æ„åŒ–ã€ç¦»çº¿æ”¯æŒ     | [æŒä¹…åŒ–ä¸­é—´ä»¶](./indexeddb-persistence-middleware-design.md) |
| **äº‘ç«¯å­˜å‚¨**   | Supabase        | å¼€æºã€å®æ—¶åŒæ­¥ã€PostgreSQL   | [Supabase é…ç½®](../setup/supabase-local-setup.md)            |
| **å¤§çº²è§†å›¾**   | react-arborist  | è™šæ‹ŸåŒ–æ¸²æŸ“ã€ç±»å‹å®‰å…¨         | [å¸ƒå±€è®¾è®¡](./mindmap-editor-layout-design.md)                |
| **å›¾å½¢æ¸²æŸ“**   | React Flow      | æˆç†Ÿç¨³å®šã€ä¸°å¯ŒåŠŸèƒ½           | [å¸ƒå±€è®¾è®¡](./mindmap-editor-layout-design.md)                |
| **å°ºå¯¸ç›‘å¬**   | ResizeObserver  | åŸç”Ÿ APIã€æ€§èƒ½ä¼˜ç§€           | [å¸ƒå±€è®¾è®¡](./mindmap-editor-layout-design.md)                |
| **å¸ƒå±€æŒä¹…åŒ–** | localStorage    | å¿«é€Ÿå“åº”ã€ç¦»çº¿å¯ç”¨           | [å¸ƒå±€è®¾è®¡](./mindmap-editor-layout-design.md)                |

### æ ¸å¿ƒè®¾è®¡åŸåˆ™

1. **é¢†åŸŸé©±åŠ¨è®¾è®¡** - åŸºäºä¸šåŠ¡é¢†åŸŸå»ºæ¨¡ï¼Œè€ŒéæŠ€æœ¯å®ç°
2. **ç±»å‹å®‰å…¨** - å……åˆ†åˆ©ç”¨ TypeScript ç±»å‹ç³»ç»Ÿ
3. **æ¸è¿›å¢å¼º** - ä¼˜å…ˆä¿è¯ç¦»çº¿åŠŸèƒ½ï¼Œåœ¨çº¿åŠŸèƒ½ä½œä¸ºå¢å¼º
4. **æ•°æ®ä¸€è‡´æ€§** - é€šè¿‡çº¦æŸå’ŒéªŒè¯ä¿è¯æ•°æ®å®Œæ•´æ€§

## ğŸš§ å¾…å®Œæˆçš„è®¾è®¡æ–‡æ¡£

æ ¹æ®ç»“æ„åˆ†ææŠ¥å‘Šï¼Œä»¥ä¸‹æ–‡æ¡£éœ€è¦åˆ›å»ºï¼š

### é«˜ä¼˜å…ˆçº§

- [ ] **æ¶æ„æ¦‚è§ˆ** (`architecture-overview.md`) - ç³»ç»Ÿæ•´ä½“æ¶æ„å›¾å’Œè¯´æ˜
- [ ] **æ•°æ®åº“è®¾è®¡** (`database-schema.md`) - å®Œæ•´çš„æ•°æ®æ¨¡å‹è®¾è®¡

### ä¸­ä¼˜å…ˆçº§

- [ ] **API è®¾è®¡** - RESTful API æ¥å£è§„èŒƒ
- [ ] **è®¤è¯æˆæƒè®¾è®¡** - ç”¨æˆ·è®¤è¯å’Œæƒé™ç®¡ç†

### ä½ä¼˜å…ˆçº§

- [ ] **éƒ¨ç½²æ¶æ„** - ç”Ÿäº§ç¯å¢ƒéƒ¨ç½²æ–¹æ¡ˆ
- [ ] **ç›‘æ§å‘Šè­¦è®¾è®¡** - ç³»ç»Ÿç›‘æ§å’Œå‘Šè­¦ç­–ç•¥

## ğŸ“ æ–‡æ¡£ç¼–å†™æŒ‡å—

### æ–°å»ºè®¾è®¡æ–‡æ¡£æ—¶åº”åŒ…å«

1. **å…ƒä¿¡æ¯**: ç‰ˆæœ¬ã€æ—¥æœŸã€ä½œè€…ã€ç›¸å…³æ–‡æ¡£
2. **å…³é”®æ¦‚å¿µ**: å®šä¹‰è¯¥è®¾è®¡å¼•å…¥çš„æ–°æ¦‚å¿µ
3. **æ¦‚è¿°**: ä¸€å¥è¯è¯´æ˜è®¾è®¡ç›®çš„
4. **èƒŒæ™¯å’ŒåŠ¨æœº**: ä¸ºä»€ä¹ˆéœ€è¦è¿™ä¸ªè®¾è®¡
5. **è®¾è®¡æ–¹æ¡ˆ**: è¯¦ç»†çš„æŠ€æœ¯æ–¹æ¡ˆ
6. **å®ç°è¦ç‚¹**: å…³é”®æ³¨æ„äº‹é¡¹
7. **ä½¿ç”¨ç¤ºä¾‹**: ç²¾ç®€çš„ä»£ç ç¤ºä¾‹
8. **è®¾è®¡å†³ç­–**: é‡è¦å†³ç­–åŠç†ç”±
9. **å‚è€ƒèµ„æ–™**: ç›¸å…³é“¾æ¥

### æ–‡æ¡£è´¨é‡è¦æ±‚

- âœ… ç»“æ„æ¸…æ™°ï¼Œå±‚æ¬¡åˆ†æ˜
- âœ… æ¦‚å¿µå®šä¹‰å‡†ç¡®
- âœ… ç¤ºä¾‹ä»£ç ç²¾ç®€ï¼ˆé¿å…å†—ä½™ï¼‰
- âœ… ä¿æŒä¸å…¶ä»–æ–‡æ¡£çš„ä¸€è‡´æ€§
- âœ… åŠæ—¶æ›´æ–°ä»¥åæ˜ å®ç°å˜åŒ–

## ğŸ” å¿«é€ŸæŸ¥æ‰¾

### æŒ‰å…³é”®è¯ç´¢å¼•

| å…³é”®è¯                         | ç›¸å…³æ–‡æ¡£                                                                                                    |
| ------------------------------ | ----------------------------------------------------------------------------------------------------------- |
| UUID, short_id, å”¯ä¸€æ€§         | [ID è®¾è®¡](./id-design.md)                                                                                   |
| Zustand, Immer, çŠ¶æ€ç®¡ç†       | [Store è®¾è®¡](./mindmap-editor-store-design.md)                                                              |
| IndexedDB, ç¦»çº¿, åŒæ­¥          | [æŒä¹…åŒ–ä¸­é—´ä»¶](./indexeddb-persistence-middleware-design.md), [æŒä¹…åŒ–ç³»ç»Ÿ](./mindmap-persistence-design.md) |
| èŠ‚ç‚¹, æ ‘ç»“æ„, order_index      | [Store è®¾è®¡](./mindmap-editor-store-design.md)                                                              |
| å†²çªè§£å†³, æ•°æ®åŒæ­¥             | [æŒä¹…åŒ–ä¸­é—´ä»¶](./indexeddb-persistence-middleware-design.md), [æŒä¹…åŒ–ç³»ç»Ÿ](./mindmap-persistence-design.md) |
| è„æ•°æ®, ä¸‰å±‚æ¶æ„, ä¸­é—´ä»¶       | [æŒä¹…åŒ–ç³»ç»Ÿ](./mindmap-persistence-design.md)                                                               |
| æ—¶é—´æˆ³å†²çªæ£€æµ‹, æ‹“æ‰‘æ’åº       | [æŒä¹…åŒ–ç³»ç»Ÿ](./mindmap-persistence-design.md)                                                               |
| Supabase, äº‘ç«¯åŒæ­¥             | [æŒä¹…åŒ–ç³»ç»Ÿ](./mindmap-persistence-design.md)                                                               |
| å¸ƒå±€, ä¸‰æ , å¤§çº²è§†å›¾, å›¾å½¢è§†å›¾ | [å¸ƒå±€è®¾è®¡](./mindmap-editor-layout-design.md)                                                               |
| react-arborist, è™šæ‹ŸåŒ–, Tree   | [å¸ƒå±€è®¾è®¡](./mindmap-editor-layout-design.md)                                                               |
| React Flow, å›¾å½¢æ¸²æŸ“           | [å¸ƒå±€è®¾è®¡](./mindmap-editor-layout-design.md)                                                               |
| ResizeObserver, å“åº”å¼         | [å¸ƒå±€è®¾è®¡](./mindmap-editor-layout-design.md)                                                               |
| localStorage, å¸ƒå±€æŒä¹…åŒ–       | [å¸ƒå±€è®¾è®¡](./mindmap-editor-layout-design.md)                                                               |
| æŠ˜å èŠ‚ç‚¹, é«˜äº®, å¯¼èˆª           | [å¸ƒå±€è®¾è®¡](./mindmap-editor-layout-design.md)                                                               |

### å¸¸è§é—®é¢˜å¯¹åº”æ–‡æ¡£

| é—®é¢˜                     | æŸ¥çœ‹æ–‡æ¡£                                                                                                    |
| ------------------------ | ----------------------------------------------------------------------------------------------------------- |
| å¦‚ä½•ç”Ÿæˆå”¯ä¸€ IDï¼Ÿ        | [ID è®¾è®¡](./id-design.md)                                                                                   |
| å¦‚ä½•ç®¡ç†æ€ç»´å¯¼å›¾çŠ¶æ€ï¼Ÿ   | [Store è®¾è®¡](./mindmap-editor-store-design.md)                                                              |
| å¦‚ä½•å®ç°ç¼–è¾‘å™¨å¸ƒå±€ï¼Ÿ     | [å¸ƒå±€è®¾è®¡](./mindmap-editor-layout-design.md)                                                               |
| å¦‚ä½•å®ç°è™šæ‹ŸåŒ–å¤§çº²è§†å›¾ï¼Ÿ | [å¸ƒå±€è®¾è®¡](./mindmap-editor-layout-design.md)                                                               |
| å¦‚ä½•å®ç°å›¾å½¢è§†å›¾ï¼Ÿ       | [å¸ƒå±€è®¾è®¡](./mindmap-editor-layout-design.md)                                                               |
| å¦‚ä½•å®ç°å¯è°ƒæ•´å®½åº¦é¢æ¿ï¼Ÿ | [å¸ƒå±€è®¾è®¡](./mindmap-editor-layout-design.md)                                                               |
| å¦‚ä½•å®ç°æŠ˜å èŠ‚ç‚¹é«˜äº®ï¼Ÿ   | [å¸ƒå±€è®¾è®¡](./mindmap-editor-layout-design.md)                                                               |
| å¦‚ä½•ä¿å­˜ç”¨æˆ·å¸ƒå±€åå¥½ï¼Ÿ   | [å¸ƒå±€è®¾è®¡](./mindmap-editor-layout-design.md)                                                               |
| å¦‚ä½•å®ç°ç¦»çº¿åŠŸèƒ½ï¼Ÿ       | [æŒä¹…åŒ–ä¸­é—´ä»¶](./indexeddb-persistence-middleware-design.md), [æŒä¹…åŒ–ç³»ç»Ÿ](./mindmap-persistence-design.md) |
| å¦‚ä½•å¤„ç†æ•°æ®åŒæ­¥å†²çªï¼Ÿ   | [æŒä¹…åŒ–ä¸­é—´ä»¶](./indexeddb-persistence-middleware-design.md), [æŒä¹…åŒ–ç³»ç»Ÿ](./mindmap-persistence-design.md) |
| å¦‚ä½•å®ç°è‡ªåŠ¨æŒä¹…åŒ–ï¼Ÿ     | [æŒä¹…åŒ–ç³»ç»Ÿ](./mindmap-persistence-design.md)                                                               |
| å¦‚ä½•è¿½è¸ªè„æ•°æ®ï¼Ÿ         | [æŒä¹…åŒ–ç³»ç»Ÿ](./mindmap-persistence-design.md)                                                               |
| å¦‚ä½•åŒæ­¥åˆ° Supabaseï¼Ÿ    | [æŒä¹…åŒ–ç³»ç»Ÿ](./mindmap-persistence-design.md)                                                               |
| å¦‚ä½•ä¼˜åŒ–å¤§é‡èŠ‚ç‚¹çš„æ€§èƒ½ï¼Ÿ | [å¸ƒå±€è®¾è®¡](./mindmap-editor-layout-design.md), [Store è®¾è®¡](./mindmap-editor-store-design.md)               |

## ğŸ“… æ›´æ–°è®°å½•

| æ—¥æœŸ       | æ›´æ–°å†…å®¹                       | æ›´æ–°è€…      |
| ---------- | ------------------------------ | ----------- |
| 2025-10-19 | æ·»åŠ æ€ç»´å¯¼å›¾ç¼–è¾‘å™¨å¸ƒå±€è®¾è®¡æ–‡æ¡£ | Claude Code |
| 2025-10-18 | æ·»åŠ æ€ç»´å¯¼å›¾æŒä¹…åŒ–ç³»ç»Ÿè®¾è®¡æ–‡æ¡£ | Claude Code |
| 2025-01-07 | åˆ›å»ºç´¢å¼•æ–‡æ¡£                   | Claude Code |

---

**ç»´æŠ¤è¯´æ˜**:

- æ·»åŠ æ–°è®¾è®¡æ–‡æ¡£åï¼Œè¯·æ›´æ–°æœ¬ç´¢å¼•
- å®šæœŸæ£€æŸ¥æ–‡æ¡£é“¾æ¥çš„æœ‰æ•ˆæ€§
- ä¿æŒåˆ†ç±»å’Œæ ‡ç­¾çš„ä¸€è‡´æ€§
